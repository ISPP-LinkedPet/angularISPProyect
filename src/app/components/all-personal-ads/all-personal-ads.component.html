<meta name="viewport" content="width=device-width, initial-scale=1.0">

<div *ngFor="let adv of returnedAds">

    <!--Mis Anuncios de Crianza-->
    <div *ngIf="adv.breeding_id!=null" class="card border-success mb-3">
        <h3 class="card-header text-dark">
            {{ adv.breed }} en {{ adv.location }}
            <span class="badge badge-secondary text-white">CRIANZA</span>
            <!--Estados del anuncio-->
            <span *ngIf="adv.transaction_status=='Offered'" class="badge badge-success text-white">Ofrecido</span>
            <span *ngIf="adv.transaction_status=='In payment'" class="badge badge-success text-white">Pago del solicitante</span>
            <span *ngIf="adv.transaction_status=='In progress'" class="badge badge-success text-white">Código de confirmación</span>
            <span *ngIf="adv.transaction_status=='Awaiting payment'" class="badge badge-success text-white">A la espera de recibir el pago</span>
            <span *ngIf="adv.transaction_status=='Completed'" class="badge badge-success text-white">A la espera de Review</span>
            <span *ngIf="adv.transaction_status=='Reviewed'" class="badge badge-success text-white">Finalizado</span>
            <!---->
        </h3>
        <h6
        class="card-header bg-success text-dark"
        *ngIf="adv.document_status == 'Accepted'">
        Revisada
        </h6>
        <h6
        class="card-header bg-warning text-dark"
        *ngIf="adv.document_status == 'In revision'">
            En revisión
        </h6>
        <div class="card-body">
            <img src="{{ env }}/{{ adv.animal_photo.split(',')[0] }}" alt="Foto/s del animal" />
            <div class="description-content">
              <!--{{breedingAd.breeding_id}}-->
              <ul>
                <li>
                  <label><strong>Edad: </strong></label>
                  {{ this.configService.calculateAge(adv.birth_date) }}
                </li>
                <li>
                  <label><strong>Pedigree: </strong></label>
                  {{ adv.pedigree == 1 ? "Sí" : "No" }}
                </li>
                <li>
                  <label><strong>Ubicación: </strong></label> {{ adv.location }}
                </li>
                <li>
                  <label><strong>Precio: </strong></label> {{ adv.price }} euros
                </li>
                <li *ngIf="adv.transaction_status == 'In progress'">
                  <label><strong>Código de confirmación: </strong></label>
                  {{ adv.codenumber }}
                </li>
              </ul>
              
              <div *ngIf="adv.transaction_status=='Awaiting payment'">
                <button
                  type="button"
                  class="btn btn-success"
                  (click)="acceptMoney(adv.breeding_id)">Recibir el pago
                </button>
            </div>
        
              <div *ngIf="adv.transaction_status == 'Offered'">
                <div *ngIf="adv.pet_id == null">
                  <button
                    type="button"
                    class="btn btn-success"
                    [routerLink]="['/breeding-edit-particular', adv.breeding_id]">
                    Editar Anuncio
                  </button>
                </div>
                <div *ngIf="adv.pet_id != null">
                  <button
                    type="button"
                    class="btn btn-success"
                    [routerLink]="['/breeding-animal-edit', adv.breeding_id]">
                    Editar Anuncio
                  </button>
                </div>
              </div>
            </div>
            <!--Sección Petciones para este anuncio-->
            <div class="adRequests" *ngIf="adv.transaction_status == 'Offered'" >
              <!--p: {{mapBreedingRequestId.get(adv.breeding_id)}}-->
              <div *ngFor="let request of mapBreedingRequestId.get(adv.breeding_id)">
                <p><strong> Usuario: </strong> {{mapBreedingReqIdUser.get(request.id)[0].name}} {{mapBreedingReqIdUser.get(request.id)[0].surname}}</p>
                <button type="button"class="btn btn-success mx-3 " [routerLink]="['/profile', request.particular_id]">
                Ver perfil de interesado
                </button>
                <button *ngIf="request.status == 'Pending'" type="button" class="btn btn-primary mx-3 " (click)="onSubmitRequest(request.id, request.publication_id, true)">
                Aceptar
                </button>
                <button *ngIf="request.status == 'Pending'" type="button" class="btn btn-danger mx-6" (click)="onSubmitRequest(request.id, request.publication_id, false)">
                Rechazar
                </button>
              </div>
            </div>

            <div class="adRequests" *ngIf="!(adv.transaction_status == 'Offered')" >
              <div *ngFor="let request of mapBreedingRequestId.get(adv.breeding_id)">
                <div *ngIf="request.status=='Accepted'">
                  <button type="button"class="btn btn-success mx-3 " [routerLink]="['/profile', request.particular_id]">
                    Ver perfil de interesado
                  </button>
                </div>
              </div>
            </div>

            <div class="adRequests" *ngIf="!(adv.transaction_status == 'Offered')">
            El anuncio ya ha sido aceptado
            </div>
            <!---->
          </div>
    </div>

    <!--Mis Anuncios de Adopciones-->
    <div *ngIf="adv.adoption_id!=null" class="card border-success mb-3 text-dark"> 
        <h3 class="card-header">
            {{ adv.breed }} en {{ adv.location }}
            <span class="badge badge-info text-white">ADOPCIÓN</span>
            <!--Estados del anuncio-->
            <span *ngIf="adv.transaction_status=='Offered'" class="badge badge-success text-white">Ofrecido</span>
            <span *ngIf="adv.transaction_status=='In payment'" class="badge badge-success text-white">Pago del solicitante</span>
            <span *ngIf="adv.transaction_status=='In progress'" class="badge badge-success text-white">Código de confirmación</span>
            <span *ngIf="adv.transaction_status=='Awaiting payment'" class="badge badge-success text-white">A la espera de recibir el pago</span>
            <span *ngIf="adv.transaction_status=='Completed'" class="badge badge-success text-white">A la espera de Review</span>
            <span *ngIf="adv.transaction_status=='Reviewed'" class="badge badge-success text-white">Finalizado</span>
            <!---->
          </h3>
          <h6
            class="card-header bg-success"
            *ngIf="adv.document_status == 'Accepted'"
          >
            Revisada
          </h6>
          <h6
            class="card-header bg-warning"
            *ngIf="adv.document_status == 'In revision'"
          >
            En revisión
          </h6>
          <div class="card-body">
            <img src="{{ env }}/{{ adv.animal_photo.split(',')[0] }}" alt="Foto/s del animal" />
            <div class="description-content">
              <!--{{breedingAd.breeding_id}}-->
              <ul>
                <li>
                  <label><strong>Nombre: </strong></label>
                  {{ adv.name == "" ? "No tiene nombre" : adv.name }}
                </li>
                <li>
                  <label><strong>Edad: </strong></label>
                    {{ this.configService.calculateAge(adv.birth_date) }}
                </li>
                <li>
                  <label><strong>Pedigree: </strong></label>
                  {{ adv.pedigree == 1 ? "Sí" : "No" }}
                </li>
                <li>
                  <label><strong>Ubicación: </strong></label> {{ adv.location }}
                </li>
                <li *ngIf="rol == 'shelter'">
                  <label><strong>Tasas: </strong></label> {{ adv.taxes }} euros
                </li>
              </ul>
        
              <div *ngIf="adv.transaction_status != 'Completed'">
                <button type="button" class="btn btn-success" [routerLink]="['/adoption-edit', adv.adoption_id]">
                  Editar Anuncio
                </button>
              </div>
            </div>
          </div>

    </div>
</div>
<pagination class="center" [totalItems]="allads.length" [itemsPerPage]="itemsPerPage" (pageChanged)="pageChanged($event)">
</pagination>
